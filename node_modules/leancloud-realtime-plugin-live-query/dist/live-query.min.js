!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-realtime/core")):"function"==typeof define&&define.amd?define("live-query",["exports","leancloud-realtime/core"],b):b(a.AV=a.AV||{},a.AV)}(this,function(a,b){"use strict";function c(a){return a&&a.__esModule?a.default:a}function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}if(!b.Protocals)throw new Error("LeanCloud Realtime SDK not installed");var e=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),f=d(function(a){var b=a.exports={version:"2.4.0"};"number"==typeof __e&&(__e=b)}),g=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},h=function(a,b,c){if(g(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},i=function(a){return"object"==typeof a?null!==a:"function"==typeof a},j=function(a){if(!i(a))throw TypeError(a+" is not an object!");return a},k=function(a){try{return!!a()}catch(a){return!0}},l=!k(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),m=e.document,n=i(m)&&i(m.createElement),o=function(a){return n?m.createElement(a):{}},p=!l&&!k(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),q=function(a,b){if(!i(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!i(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!i(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!i(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},r=Object.defineProperty,s=l?Object.defineProperty:function(a,b,c){if(j(a),b=q(b,!0),j(c),p)try{return r(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},t={f:s},u=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},v=l?function(a,b,c){return t.f(a,b,u(1,c))}:function(a,b,c){return a[b]=c,a},w=function(a,b,c){var d,g,i,j=a&w.F,k=a&w.G,l=a&w.S,m=a&w.P,n=a&w.B,o=a&w.W,p=k?f:f[b]||(f[b]={}),q=p.prototype,r=k?e:l?e[b]:(e[b]||{}).prototype;k&&(c=b);for(d in c)(g=!j&&r&&void 0!==r[d])&&d in p||(i=g?r[d]:c[d],p[d]=k&&"function"!=typeof r[d]?c[d]:n&&g?h(i,e):o&&r[d]==i?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(i):m&&"function"==typeof i?h(Function.call,i):i,m&&((p.virtual||(p.virtual={}))[d]=i,a&w.R&&q&&!q[d]&&v(q,d,i)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128;var x=w,y={}.hasOwnProperty,z=function(a,b){return y.call(a,b)},A={}.toString,B=function(a){return A.call(a).slice(8,-1)},C=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==B(a)?a.split(""):Object(a)},D=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},E=function(a){return C(D(a))},F=Math.ceil,G=Math.floor,H=function(a){return isNaN(a=+a)?0:(a>0?G:F)(a)},I=Math.min,J=function(a){return a>0?I(H(a),9007199254740991):0},K=Math.max,L=Math.min,M=function(a,b){return a=H(a),a<0?K(a+b,0):L(a,b)},N=e["__core-js_shared__"]||(e["__core-js_shared__"]={}),O=function(a){return N[a]||(N[a]={})},P=0,Q=Math.random(),R=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++P+Q).toString(36))},S=O("keys"),T=function(a){return S[a]||(S[a]=R(a))},U=function(a){return function(b,c,d){var e,f=E(b),g=J(f.length),h=M(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}}(!1),V=T("IE_PROTO"),W=function(a,b){var c,d=E(a),e=0,f=[];for(c in d)c!=V&&z(d,c)&&f.push(c);for(;b.length>e;)z(d,c=b[e++])&&(~U(f,c)||f.push(c));return f},X="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Y=Object.keys||function(a){return W(a,X)},Z=Object.getOwnPropertySymbols,$={f:Z},_={}.propertyIsEnumerable,aa={f:_},ba=function(a){return Object(D(a))},ca=Object.assign,da=!ca||k(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=ca({},a)[c]||Object.keys(ca({},b)).join("")!=d})?function(a,b){for(var c=ba(a),d=arguments.length,e=1,f=$.f,g=aa.f;d>e;)for(var h,i=C(arguments[e++]),j=f?Y(i).concat(f(i)):Y(i),k=j.length,l=0;k>l;)g.call(i,h=j[l++])&&(c[h]=i[h]);return c}:ca;x(x.S+x.F,"Object",{assign:da});var ea=f.Object.assign,fa=d(function(a){a.exports={default:ea,__esModule:!0}}),ga=c(fa),ha=v,ia={},ja=l?Object.defineProperties:function(a,b){j(a);for(var c,d=Y(b),e=d.length,f=0;e>f;)t.f(a,c=d[f++],b[c]);return a},ka=e.document&&document.documentElement,la=T("IE_PROTO"),ma=function(){},na=function(){var a,b=o("iframe"),c=X.length;for(b.style.display="none",ka.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),na=a.F;c--;)delete na.prototype[X[c]];return na()},oa=Object.create||function(a,b){var c;return null!==a?(ma.prototype=j(a),c=new ma,ma.prototype=null,c[la]=a):c=na(),void 0===b?c:ja(c,b)},pa=d(function(a){var b=O("wks"),c=e.Symbol,d="function"==typeof c;(a.exports=function(a){return b[a]||(b[a]=d&&c[a]||(d?c:R)("Symbol."+a))}).store=b}),qa=t.f,ra=pa("toStringTag"),sa=function(a,b,c){a&&!z(a=c?a:a.prototype,ra)&&qa(a,ra,{configurable:!0,value:b})},ta={};v(ta,pa("iterator"),function(){return this});var ua=function(a,b,c){a.prototype=oa(ta,{next:u(1,c)}),sa(a,b+" Iterator")},va=T("IE_PROTO"),wa=Object.prototype,xa=Object.getPrototypeOf||function(a){return a=ba(a),z(a,va)?a[va]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?wa:null},ya=pa("iterator"),za=!([].keys&&"next"in[].keys()),Aa=function(){return this},Ba=function(a,b,c,d,e,f,g){ua(c,b,d);var h,i,j,k=function(a){if(!za&&a in o)return o[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},l=b+" Iterator",m="values"==e,n=!1,o=a.prototype,p=o[ya]||o["@@iterator"]||e&&o[e],q=p||k(e),r=e?m?k("entries"):q:void 0,s="Array"==b?o.entries||p:p;if(s&&(j=xa(s.call(new a)))!==Object.prototype&&sa(j,l,!0),m&&p&&"values"!==p.name&&(n=!0,q=function(){return p.call(this)}),g&&(za||n||!o[ya])&&v(o,ya,q),ia[b]=q,ia[l]=Aa,e)if(h={values:m?q:k("values"),keys:f?q:k("keys"),entries:r},g)for(i in h)i in o||ha(o,i,h[i]);else x(x.P+x.F*(za||n),b,h);return h},Ca=function(a){return function(b,c){var d,e,f=String(D(b)),g=H(c),h=f.length;return g<0||g>=h?a?"":void 0:(d=f.charCodeAt(g),d<55296||d>56319||g+1===h||(e=f.charCodeAt(g+1))<56320||e>57343?a?f.charAt(g):d:a?f.slice(g,g+2):e-56320+(d-55296<<10)+65536)}}(!0);Ba(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=Ca(b,c),this._i+=a.length,{value:a,done:!1})});var Da=function(a,b){return{value:b,done:!!a}};Ba(Array,"Array",function(a,b){this._t=E(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,Da(1)):"keys"==b?Da(0,c):"values"==b?Da(0,a[c]):Da(0,[c,a[c]])},"values");ia.Arguments=ia.Array;for(var Ea=pa("toStringTag"),Fa=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],Ga=0;Ga<5;Ga++){var Ha=Fa[Ga],Ia=e[Ha],Ja=Ia&&Ia.prototype;Ja&&!Ja[Ea]&&v(Ja,Ea,Ha),ia[Ha]=ia.Array}var Ka=function(a,b,c){for(var d in b)c&&a[d]?a[d]=b[d]:v(a,d,b[d]);return a},La=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a},Ma=function(a,b,c,d){try{return d?b(j(c)[0],c[1]):b(c)}catch(b){var e=a.return;throw void 0!==e&&j(e.call(a)),b}},Na=pa("iterator"),Oa=Array.prototype,Pa=function(a){return void 0!==a&&(ia.Array===a||Oa[Na]===a)},Qa=pa("toStringTag"),Ra="Arguments"==B(function(){return arguments}()),Sa=function(a,b){try{return a[b]}catch(a){}},Ta=function(a){var b,c,d;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=Sa(b=Object(a),Qa))?c:Ra?B(b):"Object"==(d=B(b))&&"function"==typeof b.callee?"Arguments":d},Ua=pa("iterator"),Va=f.getIteratorMethod=function(a){if(void 0!=a)return a[Ua]||a["@@iterator"]||ia[Ta(a)]},Wa=d(function(a){var b={},c={},d=a.exports=function(a,d,e,f,g){var i,k,l,m,n=g?function(){return a}:Va(a),o=h(e,f,d?2:1),p=0;if("function"!=typeof n)throw TypeError(a+" is not iterable!");if(Pa(n)){for(i=J(a.length);i>p;p++)if((m=d?o(j(k=a[p])[0],k[1]):o(a[p]))===b||m===c)return m}else for(l=n.call(a);!(k=l.next()).done;)if((m=Ma(l,o,k.value,d))===b||m===c)return m};d.BREAK=b,d.RETURN=c}),Xa=pa("species"),Ya=function(a){var b="function"==typeof f[a]?f[a]:e[a];l&&b&&!b[Xa]&&t.f(b,Xa,{configurable:!0,get:function(){return this}})},Za=d(function(a){var b=R("meta"),c=t.f,d=0,e=Object.isExtensible||function(){return!0},f=!k(function(){return e(Object.preventExtensions({}))}),g=function(a){c(a,b,{value:{i:"O"+ ++d,w:{}}})},h=function(a,c){if(!i(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!z(a,b)){if(!e(a))return"F";if(!c)return"E";g(a)}return a[b].i},j=function(a,c){if(!z(a,b)){if(!e(a))return!0;if(!c)return!1;g(a)}return a[b].w},l=function(a){return f&&m.NEED&&e(a)&&!z(a,b)&&g(a),a},m=a.exports={KEY:b,NEED:!1,fastKey:h,getWeak:j,onFreeze:l}}),$a=t.f,_a=Za.fastKey,ab=l?"_s":"size",bb=function(a,b){var c,d=_a(b);if("F"!==d)return a._i[d];for(c=a._f;c;c=c.n)if(c.k==b)return c},cb={getConstructor:function(a,b,c,d){var e=a(function(a,f){La(a,e,b,"_i"),a._i=oa(null),a._f=void 0,a._l=void 0,a[ab]=0,void 0!=f&&Wa(f,c,a[d],a)});return Ka(e.prototype,{clear:function(){for(var a=this,b=a._i,c=a._f;c;c=c.n)c.r=!0,c.p&&(c.p=c.p.n=void 0),delete b[c.i];a._f=a._l=void 0,a[ab]=0},delete:function(a){var b=this,c=bb(b,a);if(c){var d=c.n,e=c.p;delete b._i[c.i],c.r=!0,e&&(e.n=d),d&&(d.p=e),b._f==c&&(b._f=d),b._l==c&&(b._l=e),b[ab]--}return!!c},forEach:function(a){La(this,e,"forEach");for(var b,c=h(a,arguments.length>1?arguments[1]:void 0,3);b=b?b.n:this._f;)for(c(b.v,b.k,this);b&&b.r;)b=b.p},has:function(a){return!!bb(this,a)}}),l&&$a(e.prototype,"size",{get:function(){return D(this[ab])}}),e},def:function(a,b,c){var d,e,f=bb(a,b);return f?f.v=c:(a._l=f={i:e=_a(b,!0),k:b,v:c,p:d=a._l,n:void 0,r:!1},a._f||(a._f=f),d&&(d.n=f),a[ab]++,"F"!==e&&(a._i[e]=f)),a},getEntry:bb,setStrong:function(a,b,c){Ba(a,b,function(a,b){this._t=a,this._k=b,this._l=void 0},function(){for(var a=this,b=a._k,c=a._l;c&&c.r;)c=c.p;return a._t&&(a._l=c=c?c.n:a._t._f)?"keys"==b?Da(0,c.k):"values"==b?Da(0,c.v):Da(0,[c.k,c.v]):(a._t=void 0,Da(1))},c?"entries":"values",!c,!0),Ya(b)}},db=Array.isArray||function(a){return"Array"==B(a)},eb=pa("species"),fb=function(a){var b;return db(a)&&(b=a.constructor,"function"!=typeof b||b!==Array&&!db(b.prototype)||(b=void 0),i(b)&&null===(b=b[eb])&&(b=void 0)),void 0===b?Array:b},gb=function(a,b){return new(fb(a))(b)},hb=t.f,ib=function(a,b){var c=1==a,d=2==a,e=3==a,f=4==a,g=6==a,i=5==a||g,j=b||gb;return function(b,k,l){for(var m,n,o=ba(b),p=C(o),q=h(k,l,3),r=J(p.length),s=0,t=c?j(b,r):d?j(b,0):void 0;r>s;s++)if((i||s in p)&&(m=p[s],n=q(m,s,o),a))if(c)t[s]=n;else if(n)switch(a){case 3:return!0;case 5:return m;case 6:return s;case 2:t.push(m)}else if(f)return!1;return g?-1:e||f?f:t}}(0),jb=(function(a,b,c,d,f,g){var h=e[a],j=h,m=f?"set":"add",n=j&&j.prototype,o={};l&&"function"==typeof j&&(g||n.forEach&&!k(function(){(new j).entries().next()}))?(j=b(function(b,c){La(b,j,a,"_c"),b._c=new h,void 0!=c&&Wa(c,f,b[m],b)}),ib("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(a){var b="add"==a||"set"==a;a in n&&(!g||"clear"!=a)&&v(j.prototype,a,function(c,d){if(La(this,j,a),!b&&g&&!i(c))return"get"==a&&void 0;var e=this._c[a](0===c?0:c,d);return b?this:e})}),"size"in n&&hb(j.prototype,"size",{get:function(){return this._c.size}})):(j=d.getConstructor(b,a,f,m),Ka(j.prototype,c),Za.NEED=!0),sa(j,a),o[a]=j,x(x.G+x.W+x.F,o),g||d.setStrong(j,a,f)}("Set",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{add:function(a){return cb.def(this,a=0===a?0:a,a)}},cb),function(a,b){var c=[];return Wa(a,!1,c.push,c,b),c});x(x.P+x.R,"Set",{toJSON:function(a){return function(){if(Ta(this)!=a)throw TypeError(a+"#toJSON isn't generic");return jb(this)}}("Set")});var kb=f.Set,lb=d(function(a){a.exports={default:kb,__esModule:!0}}),mb=c(lb),nb=d(function(a,b){b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),ob=c(nb),pb=pa,qb={f:pb},rb=qb.f("iterator"),sb=d(function(a){a.exports={default:rb,__esModule:!0}}),tb=t.f,ub=function(a){var b=f.Symbol||(f.Symbol={});"_"==a.charAt(0)||a in b||tb(b,a,{value:qb.f(a)})},vb=function(a,b){for(var c,d=E(a),e=Y(d),f=e.length,g=0;f>g;)if(d[c=e[g++]]===b)return c},wb=function(a){var b=Y(a),c=$.f;if(c)for(var d,e=c(a),f=aa.f,g=0;e.length>g;)f.call(a,d=e[g++])&&b.push(d);return b},xb=X.concat("length","prototype"),yb=Object.getOwnPropertyNames||function(a){return W(a,xb)},zb={f:yb},Ab=zb.f,Bb={}.toString,Cb="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Db=function(a){try{return Ab(a)}catch(a){return Cb.slice()}},Eb=function(a){return Cb&&"[object Window]"==Bb.call(a)?Db(a):Ab(E(a))},Fb={f:Eb},Gb=Object.getOwnPropertyDescriptor,Hb=l?Gb:function(a,b){if(a=E(a),b=q(b,!0),p)try{return Gb(a,b)}catch(a){}if(z(a,b))return u(!aa.f.call(a,b),a[b])},Ib={f:Hb},Jb=Za.KEY,Kb=Ib.f,Lb=t.f,Mb=Fb.f,Nb=e.Symbol,Ob=e.JSON,Pb=Ob&&Ob.stringify,Qb=pa("_hidden"),Rb=pa("toPrimitive"),Sb={}.propertyIsEnumerable,Tb=O("symbol-registry"),Ub=O("symbols"),Vb=O("op-symbols"),Wb=Object.prototype,Xb="function"==typeof Nb,Yb=e.QObject,Zb=!Yb||!Yb.prototype||!Yb.prototype.findChild,$b=l&&k(function(){return 7!=oa(Lb({},"a",{get:function(){return Lb(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=Kb(Wb,b);d&&delete Wb[b],Lb(a,b,c),d&&a!==Wb&&Lb(Wb,b,d)}:Lb,_b=function(a){var b=Ub[a]=oa(Nb.prototype);return b._k=a,b},ac=Xb&&"symbol"==typeof Nb.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof Nb},bc=function(a,b,c){return a===Wb&&bc(Vb,b,c),j(a),b=q(b,!0),j(c),z(Ub,b)?(c.enumerable?(z(a,Qb)&&a[Qb][b]&&(a[Qb][b]=!1),c=oa(c,{enumerable:u(0,!1)})):(z(a,Qb)||Lb(a,Qb,u(1,{})),a[Qb][b]=!0),$b(a,b,c)):Lb(a,b,c)},cc=function(a,b){j(a);for(var c,d=wb(b=E(b)),e=0,f=d.length;f>e;)bc(a,c=d[e++],b[c]);return a},dc=function(a,b){return void 0===b?oa(a):cc(oa(a),b)},ec=function(a){var b=Sb.call(this,a=q(a,!0));return!(this===Wb&&z(Ub,a)&&!z(Vb,a))&&(!(b||!z(this,a)||!z(Ub,a)||z(this,Qb)&&this[Qb][a])||b)},fc=function(a,b){if(a=E(a),b=q(b,!0),a!==Wb||!z(Ub,b)||z(Vb,b)){var c=Kb(a,b);return!c||!z(Ub,b)||z(a,Qb)&&a[Qb][b]||(c.enumerable=!0),c}},gc=function(a){for(var b,c=Mb(E(a)),d=[],e=0;c.length>e;)z(Ub,b=c[e++])||b==Qb||b==Jb||d.push(b);return d},hc=function(a){for(var b,c=a===Wb,d=Mb(c?Vb:E(a)),e=[],f=0;d.length>f;)!z(Ub,b=d[f++])||c&&!z(Wb,b)||e.push(Ub[b]);return e};Xb||(Nb=function(){if(this instanceof Nb)throw TypeError("Symbol is not a constructor!");var a=R(arguments.length>0?arguments[0]:void 0),b=function(c){this===Wb&&b.call(Vb,c),z(this,Qb)&&z(this[Qb],a)&&(this[Qb][a]=!1),$b(this,a,u(1,c))};return l&&Zb&&$b(Wb,a,{configurable:!0,set:b}),_b(a)},ha(Nb.prototype,"toString",function(){return this._k}),Ib.f=fc,t.f=bc,zb.f=Fb.f=gc,aa.f=ec,$.f=hc,qb.f=function(a){return _b(pa(a))}),x(x.G+x.W+x.F*!Xb,{Symbol:Nb});for(var ic="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),jc=0;ic.length>jc;)pa(ic[jc++]);for(var ic=Y(pa.store),jc=0;ic.length>jc;)ub(ic[jc++]);x(x.S+x.F*!Xb,"Symbol",{for:function(a){return z(Tb,a+="")?Tb[a]:Tb[a]=Nb(a)},keyFor:function(a){if(ac(a))return vb(Tb,a);throw TypeError(a+" is not a symbol!")},useSetter:function(){Zb=!0},useSimple:function(){Zb=!1}}),x(x.S+x.F*!Xb,"Object",{create:dc,defineProperty:bc,defineProperties:cc,getOwnPropertyDescriptor:fc,getOwnPropertyNames:gc,getOwnPropertySymbols:hc}),Ob&&x(x.S+x.F*(!Xb||k(function(){var a=Nb();return"[null]"!=Pb([a])||"{}"!=Pb({a:a})||"{}"!=Pb(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!ac(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&db(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!ac(b))return b}),d[1]=b,Pb.apply(Ob,d)}}}),Nb.prototype[Rb]||v(Nb.prototype,Rb,Nb.prototype.valueOf),sa(Nb,"Symbol"),sa(Math,"Math",!0),sa(e.JSON,"JSON",!0),ub("asyncIterator"),ub("observable");var kc=f.Symbol,lc=d(function(a){a.exports={default:kc,__esModule:!0}}),mc=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(sb),e=c(lc),f="function"==typeof e.default&&"symbol"==typeof d.default?function(a){return typeof a}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":typeof a};b.default="function"==typeof e.default&&"symbol"===f(d.default)?function(a){return void 0===a?"undefined":f(a)}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":void 0===a?"undefined":f(a)}}),nc=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(mc);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==(void 0===b?"undefined":(0,c.default)(b))&&"function"!=typeof b?a:b}}),oc=c(nc),pc=function(a,b){if(j(a),!i(b)&&null!==b)throw TypeError(b+": can't set as prototype!")},qc={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=h(Function.call,Ib.f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(a){b=!0}return function(a,d){return pc(a,d),b?a.__proto__=d:c(a,d),a}}({},!1):void 0),check:pc};x(x.S,"Object",{setPrototypeOf:qc.set});var rc=f.Object.setPrototypeOf,sc=d(function(a){a.exports={default:rc,__esModule:!0}});x(x.S,"Object",{create:oa});var tc=f.Object,uc=function(a,b){return tc.create(a,b)},vc=d(function(a){a.exports={default:uc,__esModule:!0}}),wc=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(sc),e=c(vc),f=c(mc);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+(void 0===b?"undefined":(0,f.default)(b)));a.prototype=(0,e.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(d.default?(0,d.default)(a,b):a.__proto__=b)}}),xc=c(wc),yc=b.Protocals.CommandType,zc=b.Protocals.GenericCommand,Ac=b.Protocals.AckCommand,Bc=function(a){return console.warn(a.message)},Cc=function(a){function c(d,e,f){ob(this,c);var g=oc(this,a.call(this));return g._appId=d,g.id=e,g._connection=f,g._eventemitter=new b.EventEmitter,g._querys=new mb,g}return xc(c,a),c.prototype._send=function(a){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return(b=this._connection).send.apply(b,[ga(a,{appId:this._appId,installationId:this.id,service:1})].concat(d))},c.prototype._open=function(){return this._send(new zc({cmd:yc.login}))},c.prototype.close=function(){var a=this;return this._send(new zc({cmd:yc.logout})).then(function(){return a._eventemitter.emit("close")})},c.prototype.register=function(a){this._querys.add(a)},c.prototype.deregister=function(a){this._querys.delete(a),this._querys.size||this.close().catch(Bc)},c.prototype._dispatchCommand=function(a){return a.cmd!==yc.data?(this.emit("unhandledmessage",a),b.Promise.resolve()):this._dispatchDataCommand(a)},c.prototype._dispatchDataCommand=function(a){var b=a.dataMessage,c=b.ids,d=b.msg;this.emit("message",d.map(function(a){var b=a.data;return JSON.parse(b)}));var e=new zc({cmd:yc.ack,ackMessage:new Ac({ids:c})});return this._send(e,!1).catch(Bc)},c}(b.EventEmitter),Dc=function(a){a._liveQueryClients={},a.createLiveQueryClient=function(c){if(void 0!==a._liveQueryClients[c])return b.Promise.resolve(a._liveQueryClients[c]);var d=a._open().then(function(b){var d=new Cc(a._options.appId,c,b);return b.on("reconnect",function(){return d._open().then(function(){return d.emit("reconnect")},function(a){return d.emit("reconnecterror",a)})}),d._eventemitter.on("close",function(){delete a._liveQueryClients[d.id],a._deregister(d)},a),d._open().then(function(){return a._liveQueryClients[d.id]=d,a._register(d),d})});return a._liveQueryClients[c]=d,d}},Ec=function(a,b){if(!a.installationId||1!==a.service)return!0;var c=b._liveQueryClients[a.installationId];return c?c._dispatchCommand(a).catch(function(a){return console.warn(a)}):console.warn("Unexpected message received without any live client match: %O",a),!1},Fc={name:"leancloud-realtime-plugin-live-query",onRealtimeCreate:Dc,beforeCommandDispatch:Ec};a.LiveQueryPlugin=Fc,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=live-query.min.js.map